<!DOCTYPE html>
<html lang="ru" data-theme="{{ session.get('theme', 'light') }}">
<head>
    <meta charset="UTF-8">
    <title>–ú–æ–∏ –º–∞—Ä—à—Ä—É—Ç—ã</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>

    <button id="toggle-theme">üåô</button>

    <div style="position: relative;">

        <form method="GET" action="{{ url_for('history') }}" class="filter-form">
            <div>
                <label>–ü—Ä–æ—Ñ–∏–ª—å:
                    <select name="profile">
                        <option value="">–í—Å–µ</option>
                        <option value="driving">–ê–≤—Ç–æ–º–æ–±–∏–ª—å</option>
                        <option value="walking">–ü–µ—à–∫–æ–º</option>
                        <option value="cycling">–í–µ–ª–æ—Å–∏–ø–µ–¥</option>
                    </select>
                </label>
        
                <label>–î–∞—Ç–∞ (–æ—Ç): <input type="date" name="date_from"></label>
                <label>–î–∞—Ç–∞ (–¥–æ): <input type="date" name="date_to"></label>
            </div>
        
            <div style="margin-top: 10px;">
                <label>–ú–∏–Ω. —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ (–∫–º): <input type="number" step="0.1" name="min_dist"></label>
                <label>–ú–∞–∫—Å. —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ (–∫–º): <input type="number" step="0.1" name="max_dist"></label>
                <button type="submit">üîç –ù–∞–π—Ç–∏</button>
            </div>
        </form>
        
    
    <div class="container">
        <h2>–ú–æ–∏ –º–∞—Ä—à—Ä—É—Ç—ã</h2>

        <div class="top-buttons">
            <form method="post" action="{{ url_for('clear_routes') }}" style="display:inline;">
                <button type="submit">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –º–∞—Ä—à—Ä—É—Ç—ã</button>
            </form>
            <form method="get" action="{{ url_for('export_routes') }}" style="display:inline;">
                <button type="submit">üì• –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ CSV</button>
            </form>
        </div>

        <table>
            <thead>
                <tr>
                    <th>–ù–∞—á–∞–ª–æ</th>
                    <th>–ö–æ–Ω–µ—Ü</th>
                    <th>–ü—Ä–æ—Ñ–∏–ª—å</th>
                    <th>–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ (–∫–º)</th>
                    <th>–í—Ä–µ–º—è (–º–∏–Ω)</th>
                    <th>–î–∞—Ç–∞</th>
                    <th>–£–¥–∞–ª–∏—Ç—å</th>
                </tr>
            </thead>
            <tbody>
                {% for route in routes %}
                <tr>
                    <td>{{ route.start_point }}</td>
                    <td>{{ route.end_point }}</td>
                    <td>{{ route.profile }}</td>
                    <td>{{ (route.distance / 1000)|round(2) }}</td>
                    <td>{{ (route.duration / 60)|round }}</td>
                    <td>{{ route.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
                    <td>
                        <form method="POST" action="{{ url_for('delete_route', route_id=route.id) }}" onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –º–∞—Ä—à—Ä—É—Ç?');">
                            <button type="submit">–£–¥–∞–ª–∏—Ç—å</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <a href="{{ url_for('index') }}" class="back-link">‚Üê –ù–∞–∑–∞–¥ –Ω–∞ –∫–∞—Ä—Ç—É</a>
    </div>
</div>
    <script src="{{ url_for('static', filename='theme.js') }}"></script>
</body>
</html>
